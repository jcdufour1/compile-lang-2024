type io import = std.io
type rt import = std.runtime
type coll import = std.collections

fn thing1() {
    let nums i32[3] = [8, 76, 77]

    for idx usize in 0..nums.count {
        io.printf("before 1: %d\n", *rt.static_array_access(nums, idx), "\n")
        *rt.static_array_access(nums, idx) = unsafe_cast<i32>idx
    }
    for idx usize in 0..nums.count {
        io.printf("after  1: %d\n", *rt.static_array_access(nums, idx), "\n")
    }

    for idx usize in 0..nums.count {
        io.printf("before 2: %d\n", *coll.slice_at_ref(rt.static_array_slice(nums), idx), "\n")
        *coll.slice_at_ref(rt.static_array_slice(nums), idx) = 4*unsafe_cast<i32>idx
    }
    for idx usize in 0..nums.count {
        io.printf("after  2: %d\n", *coll.slice_at_ref(rt.static_array_slice(nums), idx), "\n")
    }

    for idx usize in 0..nums.count {
        io.printf("before 3: %d\n", nums[idx])
        nums[idx] = 43*unsafe_cast<i32>idx + 1
    }
    for idx usize in 0..nums.count {
        io.printf("after 3: %d\n", nums[idx])
    }

    for idx usize in 0..nums.count {
        let ptr i32* = &nums[idx]
        io.printf("thing 4: %d\n", *ptr)
    }
}

type COUNT def = 3

fn thing2() {
    let nums i32[COUNT] = [7, 3, 2]
    for idx usize in 0..nums.count {
        io.printf("thing 5: %d\n", nums[idx])
    }
}

fn thing3() {
    let nums i32[_] = [7, 3, 2]
    for idx usize in 0..nums.count {
        io.printf("thing 5: %d\n", nums[idx])
    }
}

fn main() i32 {
    thing1()
    thing2()
    thing3()

    return 0
}
